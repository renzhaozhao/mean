/*! Tomcat360.com (c) 2015 
	Author: Renzhao
*/
define("modules/slides",["jQuery","log"],function(i,t,e){"use strict";var n=i("jQuery"),s=i("log"),r=s.log,l=(s.warn,s.error);if("undefined"==typeof n||"undefined"==typeof n.fn||"string"!=typeof n.fn.jquery)return void l("Can not find jQuery.");s.$(),r("Module Slider is loading...");var o={interval:10},a=function(i,t){return r("Slider is initializing..."),this.selector=i||".slider",this.config=n.extend({},o,t),this.interval=this.config.interval,this.version="0.0.1","string"!=typeof this.selector?this:(this.container=n(this.selector),0===this.container.length?(l("Can not find slide container, please initialize slide by yourself.","["+this.selector+"]"),this):(this.slides=this.container.find(".slide"),this.controllers=this._createControllers(this.slides),this.index=0,this.autoPlayId=-1,this._init(),r("Slider is initialized."),this))};a.prototype={_init:function(){this.slides.hide(),this.slides.eq(this.index).show();var i=this,t="<style>";return t+=".slide{background-size: auto 100%;background-position: 50% 0%;background-repeat: no-repeat;}",this.slides.each(function(i,e){e=n(e);var s=e.data("img"),r="slide-"+i.toString();e.addClass(r),t+="."+r+'{\n	background-image: url("'+s+'");\n}\n',e.removeAttr("data-img")}),t+="</style>",n("head").append(t),i._bindEvents(),i.autoPlay()},_createControllers:function(i){var t=this,e=n("<ol></ol>").appendTo(this.container);return e.addClass("controller"),i.each(function(i,s){s=n(s);var r=n("<li></li>").appendTo(e);r.click(function(){t._bindEvents()})}),e.children()},_bindEvents:function(){var i=this;return i.controllers.removeClass("active"),i.controllers.first().addClass("active"),i.controllers.click(function(){var t=n(this),e=i.controllers.index(t);i.playNext(e)}),i},playNext:function(i){return this.index===i?this:(this.autoPlayId&&window.clearInterval(this.autoPlayId),this.slides.eq(this.index).fadeOut(),this.slides.eq(i).fadeIn(),this.controllers.removeClass("active").eq(i).addClass("active"),this.index=i,this.autoPlay())},autoPlay:function(){var i=this,t=i.slides.length;return i.autoPlayId=window.setInterval(function(){i.playNext((i.index+1)%t)},1e3*this.interval),i}},e.exports=a,r("Module Slider is loaded.")});