/*! Tomcat360.com (c) 2015 
	Author: Renzhao
*/
define("modules/progress",["jQuery","log"],function(e,t,r){"use strict";var n=e("jQuery"),i=e("log"),a=i.log,s=i.warn,o=i.error;if("undefined"==typeof n||"undefined"==typeof n.fn||"string"!=typeof n.fn.jquery)return void o("Can not find jQuery.");i.$(),a("Module Progress is loading...");var d=["default","yellow","red","blue","black","green"],u={width:"default",percent:50,color:"default",animate:!0,speed:1,autorun:!0,delay:0,time:2e3},l=function(e){return"string"==typeof e&&"default"===e.toLowerCase()?!0:null==e?!0:!1},c=function(e){if("number"==typeof e)return isNaN(e)?100:e>100?100:0>e?0:e;var t=parseInt(e);return c(t)},f=function(){var e=/msie\s+(\d+?\.\d+?)/gi,t=e.exec(navigator.userAgent);if(n.isArray(t)&&t.length>=2){var r=parseFloat(t[1]);if(0>r-10)return!0}return!1},g='<div class="progress"><div class="progress-value"></div></div>',h='<div class="progress"><div class="progress-value progress-ie"></div></div>',p=function(e){var t=e.data("width"),r=e.data("percent"),n=e.hasClass("animate"),i=e.data("color"),a=e.data("speed"),s=e.data("autorun"),o=e.data("delay"),d=e.data("time"),u={};return t&&(u.width=t),void 0!==r&&(u.percent=r),n&&(u.animate=n),i&&(u.color=i),a&&(u.speed=a),s&&(u.autorun=s),o&&(u.delay=o),d&&(u.time=d),u},v=function(e,t){return a("Progress is initializing..."),this.selector=e||".progress-container","string"!=typeof this.selector?this:(this.container=n(this.selector),0===this.container.length?(s("Can not find progress container."),this):(this.init(this.container,t),f()&&(s("Add IE fix."),n(".progress-value").each(function(e,t){n(t).hasClass("progress-ie")||n(t).addClass("progress-ie")})),"undefined"!=typeof t&&t.autorun&&this.run(this.container),a("Progress is initialized."),this))};v.prototype={init:function(e,t){var r=this;if(e.length>1)return e.each(function(e,i){r.init(n(i),t)}),this;if(e.data("init"))return this;if(e.find("div.progress").length>0)return r.data("init",!0),r.data("end",!0),e;var i=p(e),a=n.extend({},u,t,i),s={};l(a.width)||(s.width=a.width),f()?e.html(h):e.html(g);var o=e.children(".progress"),c=e.find(".progress-value");return o.css(s),n.inArray(a.color.toLowerCase(),d)>=0&&(l(a.color)||o.addClass(a.color)),a.animate&&o.addClass("animate"),c.css("width","0%"),e.data("config",a),e.data("init",!0),r},run:function(e){var t=this;if(0===e.length)return e;if(e.length>1)return e.each(function(e,r){t.run(n(r))}),e;var r=document.documentElement.clientHeight,i=e[0].getBoundingClientRect().top;if(i>r)return n(window).one("scroll",function(r){t.run(e)}),e;if(e.data("end"))return e;var a=e.data("config"),s=e.find(".progress-value"),o=c(a.percent);return a.autorun?s.css("width","0%").delay(a.delay).animate({width:o+"%"},a.time,function(){e.data("end",!0)}):(s.css("width",o+"%"),e.data("end",!0)),t}},r.exports=v,a("Module Progress is loaded.")});